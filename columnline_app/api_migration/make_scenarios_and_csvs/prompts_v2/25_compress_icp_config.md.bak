# Compress ICP Config

**Stage:** SETUP
**Step:** 00B_COMPRESS_ICP
**Produces Claims:** FALSE
**Context Pack:** FALSE
**Model:** gpt-4.1

---

## Input Variables

**icp_config**
Full (thorough) ICP configuration from Onboarding step

---

## Main Prompt Template

### Role
You are a configuration compression specialist optimizing ICP configs for token efficiency while preserving essential decision-making information.

### Objective
Compress thorough ICP configuration (from onboarding) into machine-readable format that reduces token usage by 40-60% while maintaining all critical signals, scoring rules, and disqualifiers. Used for most pipeline steps (not batch composer or feedback).

### What You Receive
- Full ICP config with verbose descriptions, examples, and context

### Instructions

**Phase 1: Identify Compression Targets**

**1.1 What to Preserve (DO NOT Compress)**
- Signal types and tier rankings
- Geography tiers and specific locations
- Project type priorities and percentages
- ICP scoring rules and weights
- Hard disqualifiers
- Signal strength definitions

**1.2 What to Compress (Reduce Verbosity)**
- Long-form explanations → short phrases
- Examples and case studies → remove or drastically shorten
- Redundant descriptions → single clear statement
- Narrative context → bullet points
- Background rationale → just the decision rule

**1.3 What to Remove (Not Needed by AI)**
- Internal notes about client conversations
- Historical context about why ICP was created
- Onboarding questions and answers
- Process notes ("we should focus on...")
- Meta-commentary

**Phase 2: Compression Strategies**

**2.1 Signal Compression**

**Original (Verbose):**
```
Tier 1 Signals (Definitive):
These are the highest-value signals indicating imminent vendor selection. When we see these signals, we should prioritize immediately because the company is likely evaluating vendors within the next 1-3 months. Examples include EPCM awards (when a company hires an engineering firm, they'll need vendors soon), GC awards (general contractor selection means subcontractor decisions coming), and groundbreaking events (construction starting, vendors being selected now).
```

**Compressed (Minimal):**
```
Tier 1 (HOT): EPCM award, GC award, groundbreaking → Vendor selection 1-3 months
```

**2.2 Geography Compression**

**Original:**
```
Tier 1 Geographies (Highest Priority):
- United States: Virginia (Northern VA data center corridor), California (Silicon Valley, LA basin), Texas (Dallas, Austin, Houston), Arizona (Phoenix data centers)
- Canada: Ontario (Toronto, Ottawa industrial corridor), British Columbia (Vancouver region)

These represent the client's core markets where they have existing relationships, proven track record, and competitive advantages...
```

**Compressed:**
```
Tier 1: US (VA, CA, TX, AZ), Canada (ON, BC)
Tier 2: US (GA, NC, FL, CO), Canada (AB, QC)
Tier 3: Other US states, other Canada provinces
```

**2.3 Project Type Compression**

**Original:**
```
Data Centers (70% of focus):
Client has delivered 40+ data center projects and this is their bread and butter. They have specialized cooling infrastructure expertise, rapid deployment capabilities, and strong relationships with major hyperscalers. Project sizes typically $50M-$500M. Focus on hyperscale (100MW+), enterprise (20-100MW), and colocation facilities. Avoid edge data centers (too small, different requirements).
```

**Compressed:**
```
Data centers (70%): Hyperscale/enterprise/colo, $50M-$500M, avoid edge
Senior housing (10%): Assisted living/memory care, $20M-$100M
Logistics (10%): Warehouses/fulfillment, $30M-$200M
Multi-family (10%): 100+ units, $25M-$150M
```

**2.4 Scoring Rules Compression**

**Original:**
```
Lead Score Calculation (0-100):

Signal Strength Component (40 points possible):
- Tier 1 signal (EPCM award, GC award, groundbreaking): 25 points
- Tier 2 signal (building permit, regulatory approval): 20 points
- Tier 3 signal (project announcement, feasibility study): 15 points
- Tier 4 signal (hiring, land acquisition): 10 points
- Multiple signals: Add 5 points per additional signal, max +15 points

Geography Fit Component (20 points possible):
- Tier 1 geography: 15 points
- Tier 2 geography: 10 points
- Tier 3 geography: 5 points

[... more detail ...]
```

**Compressed:**
```
Scoring (0-100):
- Signal: T1=25, T2=20, T3=15, T4=10 (+5 per additional, max +15)
- Geography: T1=15, T2=10, T3=5
- Timing: Perfect fit=15, Good=10, Marginal=5
- Project type: Primary=20, Secondary=10
- Size: In range=10, Below=5, Above=15
Multiple signals: +5 each (max +15)
Threshold: 50+ pursue, 70+ priority, <50 skip
```

**2.5 Disqualifier Compression**

**Original:**
```
Hard Disqualifiers (Automatic Skip):
1. Government projects (federal, state, local) - Client prefers private sector due to payment terms and bureaucracy
2. Residential single-family housing - Not client's expertise, margins too low
3. Projects under $10M - Below minimum project size, not economical
4. International projects outside US/Canada - No established presence, licensing issues
5. Design-build where client must lead design - Client is design-assist only, not design-lead
```

**Compressed:**
```
Disqualifiers: Gov't projects, residential single-family, <$10M, international (non-US/CA), design-lead
```

**Phase 3: Validate Compression**

**3.1 Quality Checks**
- Can AI still calculate lead score correctly?
- Are all signal tiers clearly defined?
- Are hard disqualifiers unambiguous?
- Are geography priorities clear?
- Does compressed version preserve decision-making power?

**3.2 Token Reduction Target**
- Original: ~2,000-3,000 tokens
- Compressed: ~800-1,200 tokens (40-60% reduction)

### Output Format

Return valid JSON with compressed ICP config:

```json
{
  "signals": {
    "tier_1_hot": {
      "types": ["epcm_award", "gc_award", "groundbreaking", "construction_start"],
      "timing": "1-3 months to vendor selection",
      "score": 25
    },
    "tier_2_warm": {
      "types": ["building_permit", "regulatory_approval", "funding_secured"],
      "timing": "3-6 months to vendor selection",
      "score": 20
    },
    "tier_3_passive": {
      "types": ["project_announcement", "feasibility_complete", "rfp_released"],
      "timing": "6-12 months to vendor selection",
      "score": 15
    },
    "tier_4_weak": {
      "types": ["hiring", "land_acquisition", "zoning_application"],
      "timing": "12+ months to vendor selection",
      "score": 10
    }
  },
  "geographies": {
    "tier_1": ["US-VA", "US-CA", "US-TX", "US-AZ", "CA-ON", "CA-BC"],
    "tier_2": ["US-GA", "US-NC", "US-FL", "US-CO", "CA-AB", "CA-QC"],
    "tier_3": ["US-other", "CA-other"],
    "scoring": {"tier_1": 15, "tier_2": 10, "tier_3": 5}
  },
  "project_types": {
    "primary": {
      "data_center": {"focus": 70, "size_range": "$50M-$500M", "subtypes": ["hyperscale", "enterprise", "colocation"]},
      "score": 20
    },
    "secondary": {
      "senior_housing": {"focus": 10, "size_range": "$20M-$100M"},
      "logistics": {"focus": 10, "size_range": "$30M-$200M"},
      "multi_family": {"focus": 10, "size_range": "$25M-$150M"},
      "score": 10
    }
  },
  "scoring_rules": {
    "signal_strength": {"max": 40, "multiple_bonus": 5, "max_bonus": 15},
    "geography_fit": {"max": 20},
    "timing_fit": {"perfect": 15, "good": 10, "marginal": 5},
    "project_type": {"primary": 20, "secondary": 10},
    "project_size": {"in_range": 10, "below": 5, "above": 15},
    "total_max": 100,
    "thresholds": {"pursue": 50, "priority": 70}
  },
  "disqualifiers": [
    "government_projects",
    "residential_single_family",
    "project_size_under_10M",
    "international_non_us_canada",
    "design_lead_required"
  ],
  "compression_metadata": {
    "original_tokens": 2400,
    "compressed_tokens": 950,
    "reduction_percentage": 60,
    "compressed_at": "2026-01-12T10:00:00Z"
  }
}
```

### Constraints

**Do:**
- Reduce verbosity aggressively (remove examples, explanations)
- Preserve all decision-making data (scoring rules, tiers, disqualifiers)
- Use abbreviations and shorthand (T1, T2, T3 for tiers)
- Convert narrative to structured data
- Test that AI can still calculate lead score correctly

**Do NOT:**
- Remove signal types or scoring weights
- Drop geography tiers or locations
- Lose disqualifier criteria
- Compress so much that AI can't understand rules
- Change meanings or definitions

**Compression Targets:**
- Signal descriptions: 80% reduction (keep type, score, timing)
- Geography descriptions: 90% reduction (keep tiers, locations)
- Project type details: 70% reduction (keep focus %, size range, key subtypes)
- Scoring rules: 50% reduction (keep weights, calculations)
- Disqualifiers: 80% reduction (keep criteria names)

**Quality Validation:**
Can AI answer these questions with compressed version?
1. What score does an EPCM award in Virginia for a $200M data center get?
2. Is a $5M residential project disqualified?
3. What's the vendor selection timeline for a building permit signal?

If yes to all three → compression successful.

---

## Variables Produced

- `icp_config_compressed` - Compressed ICP configuration (40-60% smaller)
- `reduction_percentage` - Token savings achieved

---

## Integration Notes

**Model:** gpt-4.1 (sync, < 1 min)

**Purpose:** Token cost optimization. Most pipeline steps use compressed version (exceptions: batch composer, feedback steps use thorough version).

**Next Steps:**
- Compressed ICP flows to most pipeline steps (search builder, entity research, signal discovery, etc.)
- Original thorough ICP used for batch composer and client feedback review
- Saves 1,000-1,500 tokens per pipeline run (significant at scale)
